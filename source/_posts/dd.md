---
title: AngularJS [Directory and File Organization]
date: 2018-02-22 15:40:36
tags:
---
# AngularJS [Directory and File Organization](https://docs.angularjs.org/tutorial/step_04) (目录和文件组织)

此文为[AngularJS入门教程第四部分](https://docs.angularjs.org/tutorial/step_04)的翻译，如有错误请指出。

在之前的步骤中，已经看到了怎么使我们的应用模块化和可测试。而与此同样重要的还有使用易于操控代码和快速定位相关功能或应用的块的代码的方式组织我们的代码库。

因此，我们将会解释为什么和如何：

- 把每个实体放在他自己的文件中
- 根据特征域而不是方法来组织我们的代码
- 把代码分成其它模块可以依赖的模块

## 一个特征一个文件

出于简单考虑，把所有东西都放在同一个文件或者每个类型有一个文件好像很吸引人的样子。例如：所有控制器放在一个文件，所有的组件放在另一个文件，所有服务放在一个文件那样子。一开始看起来好像很不错的样子，但是随着应用的成长，就会变得难以维护。当我们增加越来越多的特征，我们的文件就会变得越来越大并且难以导航和查找代码。

因此我们需要把每个功能/单元放在它自己的文件。每个独立的控制器应该在它自己的文件里定义，组件也是相同。

## 根据特征组织

所以，现在我们知道了我们应该把所有东西放在它们自己的文件夹里，我们的`app/`目录将很快充满很多个文件和测试文件（记住我们要把单元测试文件和相应的代码放在一起）。更重要的是，逻辑关联的文件不应该被放在一起。这将会使得定位所有与特定块关联的文件或改变代码或修复bug变得相当困难。

所以我们应该怎么做？

我们将根据特征把我们的文件归类到不同的目录下。

## 使用模块

根据之前提及的，使用模块化的结构的好处之一是代码复用——不仅在相同的应用下，在跨应用程序下也是一样的。这里有一个使得代码能很好被复用的最终步骤：

- 每个特征/区域都应该定义自己的模块，而所有相关的实体应该在这个模块中注册。

现在就拿`phoneList`功能作为一个栗子。首先，`phoneList`组件会在`phonecatApp`模块上注册：

```javascript
angular.
  module('phonecatApp').
  component('phoneList', ...);
```

同样的，一起的测试文件也会在每次测试前导入`phonecatApp`模块。现在，假设在我们的另一个项目中同样需要一列电话。多亏了我们的模块化结构，我们不需要重造轮子，我们只需要简单地复制`phone-list/`目录到我们的另一个项目中，并且在`index.html`中添加必要的script引用。这样就完了吗？

还没有那么快。新项目并不知道`phonecatApp`模块。因此我们需要把所有引用的`phonecatApp`改成该项目主模块的名字。你可以想象出来，这十分繁琐和容易出错。

然而，这里有个更好的办法！

每个功能/区域。都会定义自己的模块并且注册了所有相关的功能。主模块将会在每个功能/区域声明依赖。现在只需要复制功能目录并且将功能模块作为依赖添加在新项目的主模块中就可以做到复用相同的代码。

## 外部模板

既然我们在做重构，就让我们多做一件事吧。根据我们学到的，组件是有模板的，就是决定我们的数据如何防止和展示给用户的基本的HTML框架。然而把代码字符串中并不好，特别是更大的模板。如果我们能把HTML代码放在`.html`文件中回更好。这样子，我们也能使用编辑器提供的功能（例如代码高亮和自动补全）并且能让我们的组件定义更清晰。

因此，虽然使用内联组件模板挺好的，但是我们将使用外部引用外部模板。为了表明我们正在使用一个外部模板，可以使用`templateUrl` 属性并且制定引入模板的URL。因为我们想要让模板靠近组件定义的地方，我们把它和组件放在一起。
